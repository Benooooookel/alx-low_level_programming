the more function and nasted loop
